!function(t){"use strict";function e(t){var e;t&&("complete"===document.readyState?t(document):e=setInterval(function(){"complete"===document.readyState&&(t(document),clearInterval(e))},10))}function n(t){var e;if(u.isObject(t))for(e in t)t.hasOwnProperty(e)&&s.register(e,[],function(t){return function(){return t}}(t[e]))}function r(t,e,n){var r,o,i;for(r=0,o=e.length;o>r;r++)i=e[r],i.hasAttribute("data-"+t)&&(p[t]||(p[t]=[]),p[t].push(i),n(i))}function o(t,e,n,o,i){function c(t){var e=i?{container:i,element:t}:t;n?o.apply(e,s.resolve(n)):o.call(e)}p.hasOwnProperty(t)?(u.warn("element '"+t+"' already defined"),p[t].forEach(function(t){c(t)})):r(t,e,c)}var i,u,s,c,a,l={},f={},p={},h=void 0,d=t;u={isDefined:function(t){return"undefined"!=typeof t},isBoolean:function(t){return"boolean"==typeof t},def:function(t,e){return"undefined"==typeof t?e:t},error:function(t){throw new Error(d+": "+t)},warn:function(t){u.log("Warning: "+t)},log:function(t){i.log&&console.log(d+": "+t)},argsToArray:function(t){return Array.prototype.slice.call(t)},getGID:function(t){return t=u.def(t,""),f[t]=u.def(f[t],0),t+ ++f[t]},rand:function(t,e){return e=e||0,(e>t||e>t)&&u.error("rand: invalid range."),Math.floor(Math.random()*(t-e+1))+e}},c=["Array","Object","Arguments","Function","String","Number","Date","RegExp","HTMLImageElement"];for(var y=0;y<c.length;y++)u["is"+c[y]]=function(t){return function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}(c[y]);return s={unresolved:{},modules:{},register:function(t,e,n,r){return this.unresolve(t),this.unresolved[t]={deps:e,func:n,scope:r},this},unresolve:function(t){this.modules[t]&&delete this.modules[t]},setModule:function(t,e){return this.modules[t]=e,this},getDependency:function(t,e){var n=this.modules[t];return n?void e(n):(n=this.unresolved[t])?(u.log("Resolving dependencies for '"+t+"'"),void this.resolveAndApply(n.deps,n.func,n.scope,function(n){u.isObject(n)&&(n.getType=function(){return t}),e(n)})):void u.warn("Module '"+t+"' not found")},resolve:function(t,e){var n,r,o=[];if(!t||!t.length)return void e();for(r=0;r<t.length;r++)n=t[r],this.getDependency(n,function(r){r?o.push(r):u.error("Can't resolve "+n),o.length===t.length&&e(o)})},apply:function(t,e,r){var o=e.apply(r||i,t);return n(o),o},resolveAndApply:function(t,e,n,r){var o=this;this.resolve(t,function(t){var i=o.apply(t,e,n);r&&r(i)})},process:function(t,e){u.isArray(t)?t.forEach(function(t){u.isString(t)?this.getDependency(t,function(t){e(t)}):e(t)}):u.isString(t)?this.getDependency(t,function(t){e(t)}):e(t)}},i=function(t,e,n,r){return u.isArray(t)?s.resolveAndApply(t,e,n):u.isFunction(t)?s.apply([],t,e):u.isArray(e)&&u.isFunction(n)?s.register(t,e,n,r):u.isFunction(e)&&s.register(t,[],e,n),null},i.use=function(t,e,n){u.isString(t)&&(t=[t]),i(t,e,n)},i.register=function(t,e,n,r){i(t,e,n,r)},i.unresolve=function(t){s.unresolve(t)},i.noConflict=function(){return window[t]=h,i},i.element=function(t,n,r){var i;return u.isFunction(n)?r=n:u.isArray(n)?i=n:u.error("element: second argument should be function or dependency array."),e(function(e){var n;if(!a){if(n=e.getElementsByTagName("body"),!n||!n[0])return;a=n[0].querySelectorAll("*")}o(t,a,i,r)}),this},i.subElement=function(t,n,r,i){var s;return u.isFunction(r)?i=r:u.isArray(r)?s=r:u.error("subElement: third argument should be function or dependency array."),e(function(){var e,r,u,c,a=p[n];for(e=0,u=a.length;u>e;e++)c=a[e],r=c.querySelectorAll("*"),o(t,r,s,i,c)}),this},i.onDocumentReady=i.ready=e,i.log=!0,s.setModule("helper",u).setModule("Helper",u).setModule("Util",u).setModule("injector",s).setModule("Injector",s).setModule("Element",i.element).setModule("SubElement",i.subElement).setModule("appConfig",l),window[t]&&(u.warn("a preexisting value at namespace '"+t+"' has been overwritten."),h=window[t]),window[t]=i,window.register||(window.register=i.register),window.use||(window.use=i.use),i}("kilo"),kilo("Canvas",[],function(){"use strict";return{clearContext:function(t,e,n){t.clearRect(0,0,e,n)},drawBackground:function(t,e,n,r,o,i){t.fillStyle=i||"red",t.fillRect(r||0,o||0,e,n)},drawBorder:function(t,e,n,r,o,i){t.beginPath(),t.strokeStyle=i||"black",t.rect(r||0,o||0,e,n),t.stroke(),t.closePath()}}}),kilo("Factory",["Obj","Pool"],function(t){"use strict";return function(e){var n=t.mixin([e]);return n}}),kilo("Func",[],function(){"use strict";function t(t){var e=Array.prototype.slice.call(arguments,1);return function(){for(var n=e.slice(),r=0;r<arguments.length;r++)n.push(arguments[r]);return t.apply(this,n)}}function e(e,n){return t(n,e)}function n(t){return function(){var e=Array.prototype.slice.call(arguments),n=e.length;return function(r){return e[n]=r,t.apply(this,e)}}}return{partial:t,fastPartial:n,wrap:e}}),register("HashArray",function(){"use strict";function t(){this.values=[],this.keyMap={}}function e(t,e){var n;for(n in t)t.hasOwnProperty(n)&&t[n]>e&&t[n]--}function n(t,e){var n;for(n in t)t.hasOwnProperty(n)&&t[n]>=e&&t[n]++}return t.prototype.set=function(t,e){return this.keyMap[t]?(this.values[this.keyMap[t]]=e,!0):(this.values.push(e),this.keyMap[t]=this.values.length-1,!1)},t.prototype.splice=function(t,e,r){var o=this.keyMap[t]+1;this.values.splice(o,0,r),n(this.keyMap,o),this.keyMap[e]=o},t.prototype.get=function(t){return this.values[this.keyMap[t]]},t.prototype.remove=function(t){var n=this.keyMap[t];this.values.splice(n,1),e(this.keyMap,n),delete this.keyMap[t]},t.prototype.removeAll=function(){var t,e=this.keyMap;this.values.length=0;for(t in e)delete e[t]},t.prototype.getIdByIndex=function(t){var e,n=this.keyMap;for(e in n)if(n[e]===t)return e;return""},t.prototype.getKeys=function(){var t,e=this.size(),n=[];for(t=0;e>t;t++)n.push(this.getIdByIndex(t));return n},t.prototype.getValues=function(){return this.values},t.prototype.size=function(){return this.values.length},t}),kilo("KeyStore",["HashArray","Util"],function(t,e){"use strict";function n(){this.lastId=0,this.store=new t}return n.prototype.get=function(t){return this.store.get(t)},n.prototype.set=function(t,n){var r;return e.isDefined(n)?r=t||this.lastId++:(r=this.lastId++,n=t),this.store.add(r,n),r},n.prototype.setGroup=function(t,n){var r,o;return e.isDefined(n)?(r=t,e.isDefined(r)?o=this.get(r):(r=this.lastId++,o=[],this.store.add(r,o))):(r=this.lastId++,n=t,o=[],this.store.add(r,o)),o?o.push(n):console.error("Jack2d: keyStore: id '"+r+"' not found."),r},n.prototype.clear=function(t){e.isDefined(t)?this.store.remove(t):this.store.removeAll()},n.prototype.getItems=function(){return this.store.items},n}),kilo("Merge",["Obj"],function(t){"use strict";return t.merge.bind(t)}),kilo("Obj",["Injector","Util","Func","Pool"],function(t,e,n,r){"use strict";function o(t,e,n,o){return t=t||r.getObject(),e=e||r.getObject(),Object.keys(t).forEach(function(r){i(t,e,r,n,o)}),e}function i(t,r,o,i,u){return r.hasOwnProperty(o)?i?(r[o]=n.wrap(r[o],t[o]),e.log("Merge: wrapped '"+o+"'")):u?e.error("Failed to merge mixin. Method '"+o+"' caused a name collision."):(r[o]=t[o],e.log("Merge: overwrote '"+o+"'")):r[o]=t[o],r}function u(t,n){var r={};return Object.keys(t).forEach(function(o){e.isFunction(t[o])&&(r[o]=s(t[o],t,n))}),r}function s(t,n,r){return function(){var o=e.argsToArray(arguments);return r?(o.unshift(t),r.apply(n,o)):t.apply(n,o)}}function c(n,r){e.isArray(n)?n.forEach(function(n){e.isString(n)&&(n=t.getDependency(n)),r(n)}):(e.isString(n)&&(n=t.getDependency(n)),r(n))}function a(t,e,n){Object.keys(t).forEach(function(r){t[r]===e&&(t[r]=n)})}function l(t,e){return u(t,e)}function f(t){return p(t)}function p(t,e){var n;e=e||r.getObject();for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function h(t){var n,r="";if(e.isObject(t))for(n in t)t.hasOwnProperty(n)&&!e.isFunction(t[n])&&(r+=n+": "+t[n]+"<br>");return r}function d(t){var e;for(e in t)t.hasOwnProperty(e)&&delete t[e];return t}function y(t){return g(t)}function g(t,e,n){return c(t,function(t){e=o(t,e,!1,n)}),e}function v(t,e){return c(t,function(t){e=o(t,e,!0)}),e}return{print:h,clear:d,clone:y,quickClone:f,merge:g,quickMerge:p,wrap:v,augment:l,replaceMethod:a}}),kilo("Pool",[],function(){"use strict";function t(){var t=o.pop();return t||(t={}),t}function e(t){var e;for(e in t)t.hasOwnProperty(e)&&delete t[e];return t}function n(t){o.push(e(t))}function r(){return o.length}var o=[];return{getObject:t,killObject:n,available:r}}),kilo("rect",[],function(){"use strict";function t(t,e,n){return!(t<n.left||t>n.right||e<n.top||e>n.bottom)}function e(t,e){return!(t.left<e.left||t.right>e.right||t.top<e.top||t.bottom>e.bottom)}function n(t,e){var n=!(t.left<e.left||t.right>e.right);return n?!1:t.left-e.left}function r(t,e){return!(t<e.left||t>e.right)}function o(t,e){var n=!(t.top<e.top||t.bottom>e.bottom);return n?!1:t.top-e.top}function i(t,e){return!(t<e.top||t>e.bottom)}function u(t,e){var n=!(e.left>=t.right||e.right<=t.left);return n?t.left-e.left:!1}function s(t,e){var n=!(e.top>=t.bottom||e.bottom<=t.top);return n?t.top-e.top:!1}return{setLeft:function(t){return this.left=t,this},setTop:function(t){return this.top=t,this},setRight:function(t){return this.right=t,this},setBottom:function(t){return this.bottom=t,this},containsPoint:t,containsRect:e,containsX:r,containsY:i,containsRectX:n,containsRectY:o,intersectsRectX:u,intersectsRectY:s}}),kilo("Wrap",["Obj"],function(t){"use strict";return t.wrap.bind(t)});